<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Open House Check-In | 5537 W Kensington Cir, Highland</title>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,300;1,400&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --cream: #F9F6F0;
      --warm-white: #FDFBF8;
      --charcoal: #1C1C1E;
      --mid: #5A5A5A;
      --light: #9A9A9A;
      --gold: #B8965A;
      --gold-light: #D4B07A;
      --navy: #1A2744;
      --border: #E2DDD6;
      --error: #C0392B;
    }

    body {
      font-family: 'DM Sans', sans-serif;
      background: var(--cream);
      color: var(--charcoal);
      min-height: 100vh;
    }

    /* ── HERO ── */
    .hero {
      position: relative;
      background: var(--navy);
      color: white;
      padding: 48px 24px 40px;
      overflow: hidden;
    }

    .hero::before {
      content: '';
      position: absolute;
      inset: 0;
      background: url('https://photos.zillowstatic.com/fp/181ea017fc50dcd90289e5edee63b78f-cc_ft_960.jpg') center/cover no-repeat;
      opacity: 0.22;
    }

    .hero::after {
      content: '';
      position: absolute;
      bottom: 0; left: 0; right: 0;
      height: 80px;
      background: linear-gradient(to bottom, transparent, var(--cream));
    }

    .hero-inner {
      position: relative;
      z-index: 1;
      max-width: 480px;
      margin: 0 auto;
    }

    .open-house-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: var(--gold);
      color: white;
      font-family: 'DM Sans', sans-serif;
      font-size: 10px;
      font-weight: 500;
      letter-spacing: 0.14em;
      text-transform: uppercase;
      padding: 5px 12px;
      border-radius: 2px;
      margin-bottom: 20px;
    }

    .open-house-badge::before {
      content: '';
      width: 6px; height: 6px;
      background: white;
      border-radius: 50%;
      animation: pulse 1.8s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.5; transform: scale(0.7); }
    }

    .hero h1 {
      font-family: 'Cormorant Garamond', serif;
      font-weight: 300;
      font-size: clamp(26px, 6vw, 36px);
      line-height: 1.1;
      letter-spacing: -0.01em;
      margin-bottom: 8px;
    }

    .hero-address {
      font-size: 13px;
      color: rgba(255,255,255,0.6);
      letter-spacing: 0.04em;
      margin-bottom: 24px;
    }

    .hero-stats {
      display: flex;
      gap: 24px;
    }

    .stat {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .stat-value {
      font-family: 'Cormorant Garamond', serif;
      font-size: 20px;
      font-weight: 400;
      color: var(--gold-light);
    }

    .stat-label {
      font-size: 10px;
      color: rgba(255,255,255,0.5);
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }

    /* ── AGENT CARD ── */
    .agent-card {
      max-width: 480px;
      margin: 0 auto;
      padding: 0 24px;
      transform: translateY(-20px);
    }

    .agent-card-inner {
      background: white;
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 16px 20px;
      display: flex;
      align-items: center;
      gap: 16px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.06);
    }

    .agent-avatar {
      width: 48px; height: 48px;
      border-radius: 50%;
      background: var(--navy);
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: 'Cormorant Garamond', serif;
      font-size: 20px;
      color: var(--gold-light);
      flex-shrink: 0;
    }

    .agent-info {
      flex: 1;
    }

    .agent-name {
      font-weight: 500;
      font-size: 14px;
      color: var(--charcoal);
    }

    .agent-company {
      font-size: 12px;
      color: var(--light);
      margin-top: 2px;
    }

    .agent-divider {
      width: 1px;
      height: 36px;
      background: var(--border);
      flex-shrink: 0;
    }

    .preferred-lender {
      text-align: right;
      flex-shrink: 0;
    }

    .preferred-lender-label {
      font-size: 9px;
      color: var(--light);
      letter-spacing: 0.1em;
      text-transform: uppercase;
      margin-bottom: 2px;
    }

    .preferred-lender-name {
      font-size: 13px;
      font-weight: 500;
      color: var(--navy);
    }

    .preferred-lender-co {
      font-size: 11px;
      color: var(--gold);
    }

    /* ── STEP FLOW ── */
    .form-section {
      max-width: 480px;
      margin: 0 auto;
      padding: 0 24px 48px;
    }

    /* Progress bar */
    .progress-bar-wrap {
      margin-bottom: 28px;
    }

    .progress-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }

    .progress-label {
      font-size: 10px;
      font-weight: 500;
      letter-spacing: 0.14em;
      text-transform: uppercase;
      color: var(--gold);
    }

    .progress-count {
      font-size: 11px;
      color: var(--light);
    }

    .progress-track {
      height: 3px;
      background: var(--border);
      border-radius: 2px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: var(--gold);
      border-radius: 2px;
      transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* Steps container */
    .steps-container {
      position: relative;
      overflow: hidden;
    }

    .step {
      display: none;
      animation: stepIn 0.35s cubic-bezier(0.4, 0, 0.2, 1) forwards;
    }

    .step.active { display: block; }
    .step.exit { display: block; animation: stepOut 0.25s cubic-bezier(0.4, 0, 0.2, 1) forwards; }

    @keyframes stepIn {
      from { opacity: 0; transform: translateX(24px); }
      to   { opacity: 1; transform: translateX(0); }
    }

    @keyframes stepOut {
      from { opacity: 1; transform: translateX(0); }
      to   { opacity: 0; transform: translateX(-24px); }
    }

    .step-question {
      font-family: 'Cormorant Garamond', serif;
      font-size: 26px;
      font-weight: 300;
      color: var(--charcoal);
      line-height: 1.2;
      margin-bottom: 20px;
    }

    .step-sub {
      font-size: 13px;
      color: var(--light);
      margin-top: -14px;
      margin-bottom: 20px;
      line-height: 1.5;
    }

    /* Text inputs */
    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-bottom: 16px;
    }

    .form-group {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    label {
      font-size: 11px;
      font-weight: 500;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      color: var(--mid);
    }

    input[type="text"],
    input[type="email"],
    input[type="tel"] {
      width: 100%;
      padding: 13px 14px;
      border: 1px solid var(--border);
      border-radius: 4px;
      font-family: 'DM Sans', sans-serif;
      font-size: 16px;
      color: var(--charcoal);
      background: white;
      transition: border-color 0.2s, box-shadow 0.2s;
      -webkit-appearance: none;
      appearance: none;
    }

    input:focus {
      outline: none;
      border-color: var(--navy);
      box-shadow: 0 0 0 3px rgba(26,39,68,0.08);
    }

    input.error { border-color: var(--error); }

    .error-msg {
      font-size: 11px;
      color: var(--error);
      display: none;
    }
    .error-msg.show { display: block; }

    /* Choice buttons (radio replacement) */
    .choice-group {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .choice-btn {
      position: relative;
      cursor: pointer;
    }

    .choice-btn input[type="radio"] {
      position: absolute;
      opacity: 0;
      width: 0; height: 0;
    }

    .choice-btn label {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 18px;
      border: 1.5px solid var(--border);
      border-radius: 6px;
      font-size: 15px;
      font-weight: 400;
      letter-spacing: 0;
      text-transform: none;
      color: var(--charcoal);
      background: white;
      cursor: pointer;
      transition: all 0.15s;
    }

    .choice-btn label::after {
      content: '';
      width: 18px; height: 18px;
      border-radius: 50%;
      border: 2px solid var(--border);
      flex-shrink: 0;
      transition: all 0.15s;
    }

    .choice-btn input:checked + label {
      border-color: var(--navy);
      background: rgba(26,39,68,0.04);
      color: var(--navy);
      font-weight: 500;
    }

    .choice-btn input:checked + label::after {
      background: var(--navy);
      border-color: var(--navy);
      box-shadow: inset 0 0 0 3px white;
    }

    /* Next / Submit buttons */
    .step-btn {
      width: 100%;
      padding: 16px;
      background: var(--navy);
      color: white;
      border: none;
      border-radius: 4px;
      font-family: 'DM Sans', sans-serif;
      font-size: 14px;
      font-weight: 500;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      cursor: pointer;
      transition: background 0.2s, transform 0.1s;
      margin-top: 20px;
    }

    .step-btn:hover { background: #243660; }
    .step-btn:active { transform: scale(0.99); }

    .privacy-note {
      text-align: center;
      font-size: 11px;
      color: var(--light);
      margin-top: 12px;
      line-height: 1.5;
    }

    /* submit */
    .submit-btn {
      width: 100%;
      padding: 16px;
      background: var(--navy);
      color: white;
      border: none;
      border-radius: 4px;
      font-family: 'DM Sans', sans-serif;
      font-size: 14px;
      font-weight: 500;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      cursor: pointer;
      transition: background 0.2s, transform 0.1s;
      margin-top: 8px;
    }

    .submit-btn:hover { background: #243660; }
    .submit-btn:active { transform: scale(0.99); }

    .privacy-note {
      text-align: center;
      font-size: 11px;
      color: var(--light);
      margin-top: 12px;
      line-height: 1.5;
    }

    /* ── SUCCESS STATE ── */
    #success-screen {
      display: none;
      min-height: 100vh;
      flex-direction: column;
    }

    #success-screen.show {
      display: flex;
    }

    .success-hero {
      background: var(--navy);
      padding: 48px 24px 36px;
      text-align: center;
      color: white;
      position: relative;
      overflow: hidden;
    }

    .success-hero::before {
      content: '';
      position: absolute;
      inset: 0;
      background: url('https://photos.zillowstatic.com/fp/41e2da0a699e96ac7fcea46edce0dcc9-cc_ft_576.jpg') center/cover no-repeat;
      opacity: 0.15;
    }

    .success-hero-inner {
      position: relative;
      z-index: 1;
    }

    .checkmark {
      width: 56px; height: 56px;
      border-radius: 50%;
      background: var(--gold);
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 20px;
      animation: pop 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    @keyframes pop {
      from { transform: scale(0); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }

    .checkmark svg { width: 24px; height: 24px; }

    .success-hero h2 {
      font-family: 'Cormorant Garamond', serif;
      font-weight: 300;
      font-size: 28px;
      margin-bottom: 8px;
    }

    .success-hero p {
      font-size: 14px;
      color: rgba(255,255,255,0.65);
      line-height: 1.5;
    }

    .success-body {
      flex: 1;
      max-width: 480px;
      width: 100%;
      margin: 0 auto;
      padding: 32px 24px 48px;
    }

    .cta-card {
      background: white;
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 24px;
      margin-bottom: 16px;
    }

    .cta-card-eyebrow {
      font-size: 10px;
      letter-spacing: 0.14em;
      text-transform: uppercase;
      color: var(--gold);
      font-weight: 500;
      margin-bottom: 8px;
    }

    .cta-card h3 {
      font-family: 'Cormorant Garamond', serif;
      font-size: 22px;
      font-weight: 400;
      color: var(--charcoal);
      margin-bottom: 8px;
      line-height: 1.2;
    }

    .cta-card p {
      font-size: 13px;
      color: var(--mid);
      line-height: 1.6;
      margin-bottom: 20px;
    }

    .cta-link {
      display: block;
      width: 100%;
      padding: 14px;
      background: var(--gold);
      color: white;
      border: none;
      border-radius: 4px;
      font-family: 'DM Sans', sans-serif;
      font-size: 13px;
      font-weight: 500;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      text-align: center;
      text-decoration: none;
      cursor: pointer;
      transition: background 0.2s;
    }

    .cta-link:hover { background: #A37D45; }

    .receipt-card {
      background: var(--cream);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 20px 24px;
    }

    .receipt-label {
      font-size: 10px;
      letter-spacing: 0.14em;
      text-transform: uppercase;
      color: var(--light);
      margin-bottom: 12px;
    }

    .receipt-row {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      padding: 6px 0;
      border-bottom: 1px solid var(--border);
      font-size: 13px;
    }

    .receipt-row:last-child { border-bottom: none; }
    .receipt-key { color: var(--light); }
    .receipt-val { font-weight: 500; color: var(--charcoal); }

    /* animations */
    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(16px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .animate { animation: fadeUp 0.5s ease forwards; opacity: 0; }
    .delay-1 { animation-delay: 0.1s; }
    .delay-2 { animation-delay: 0.2s; }
    .delay-3 { animation-delay: 0.3s; }
    .delay-4 { animation-delay: 0.4s; }
  </style>
</head>
<body>

<!-- ════════════════════════════════
     FORM SCREEN
════════════════════════════════ -->
<div id="form-screen">

  <!-- Hero -->
  <div class="hero">
    <div class="hero-inner">
      <div class="open-house-badge">Open House · Saturday, Feb 21</div>
      <h1>5537 W Kensington Cir<br>Highland, UT 84003</h1>
      <p class="hero-address">Windsor Meadows · MLS #2135912</p>
      <div class="hero-stats">
        <div class="stat">
          <span class="stat-value">$980K</span>
          <span class="stat-label">List Price</span>
        </div>
        <div class="stat">
          <span class="stat-value">5 / 4</span>
          <span class="stat-label">Bed / Bath</span>
        </div>
        <div class="stat">
          <span class="stat-value">3,761</span>
          <span class="stat-label">Sq Ft</span>
        </div>
        <div class="stat">
          <span class="stat-value">0.25 ac</span>
          <span class="stat-label">Lot Size</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Agent Card -->
  <div class="agent-card">
    <div class="agent-card-inner">
      <div class="agent-avatar">TK</div>
      <div class="agent-info">
        <div class="agent-name">Tawnya Krull</div>
        <div class="agent-company">Century 21 Lifestyle · 801-318-1424</div>
      </div>
      <div class="agent-divider"></div>
      <div class="preferred-lender">
        <div class="preferred-lender-label">Preferred Lender</div>
        <div class="preferred-lender-name">Nick</div>
        <div class="preferred-lender-co">West Ridge Financial</div>
      </div>
    </div>
  </div>

  <!-- Conversational Step Form -->
  <div class="form-section">

    <!-- Progress -->
    <div class="progress-bar-wrap">
      <div class="progress-meta">
        <span class="progress-label">Check-In</span>
        <span class="progress-count" id="progress-count">Step 1 of 6</span>
      </div>
      <div class="progress-track">
        <div class="progress-fill" id="progress-fill" style="width: 16.6%"></div>
      </div>
    </div>

    <div class="steps-container">

      <!-- Step 1: Name -->
      <div class="step active" id="step-1">
        <h2 class="step-question">What's your name?</h2>
        <div class="form-row">
          <div class="form-group">
            <label for="fname">First Name</label>
            <input type="text" id="fname" name="fname" placeholder="Jane" autocomplete="given-name" />
            <span class="error-msg" id="fname-err">Required</span>
          </div>
          <div class="form-group">
            <label for="lname">Last Name</label>
            <input type="text" id="lname" name="lname" placeholder="Smith" autocomplete="family-name" />
            <span class="error-msg" id="lname-err">Required</span>
          </div>
        </div>
        <button class="step-btn" onclick="nextStep(1)">Continue →</button>
      </div>

      <!-- Step 2: Email -->
      <div class="step" id="step-2">
        <h2 class="step-question">What's your email address?</h2>
        <p class="step-sub">We'll send you property details after the open house.</p>
        <div class="form-group">
          <label for="email">Email Address</label>
          <input type="email" id="email" name="email" placeholder="jane@email.com" autocomplete="email" />
          <span class="error-msg" id="email-err">Valid email required</span>
        </div>
        <button class="step-btn" onclick="nextStep(2)">Continue →</button>
      </div>

      <!-- Step 3: Phone -->
      <div class="step" id="step-3">
        <h2 class="step-question">And your phone number?</h2>
        <p class="step-sub">So Tawnya can reach you directly if you have questions.</p>
        <div class="form-group">
          <label for="phone">Phone Number</label>
          <input type="tel" id="phone" name="phone" placeholder="(801) 555-0100" autocomplete="tel" />
          <span class="error-msg" id="phone-err">Valid phone number required</span>
        </div>
        <button class="step-btn" onclick="nextStep(3)">Continue →</button>
      </div>

      <!-- Step 4: Working with agent -->
      <div class="step" id="step-4">
        <h2 class="step-question">Are you currently working with a buyer's agent?</h2>
        <div class="choice-group">
          <div class="choice-btn">
            <input type="radio" name="has_agent" id="agent-yes" value="Yes" onchange="autoNext(4)" />
            <label for="agent-yes">Yes, I have an agent</label>
          </div>
          <div class="choice-btn">
            <input type="radio" name="has_agent" id="agent-no" value="No" onchange="autoNext(4)" />
            <label for="agent-no">No, not yet</label>
          </div>
          <div class="choice-btn">
            <input type="radio" name="has_agent" id="agent-maybe" value="Just Looking" onchange="autoNext(4)" />
            <label for="agent-maybe">Just browsing for now</label>
          </div>
        </div>
      </div>

      <!-- Step 5: Pre-approved -->
      <div class="step" id="step-5">
        <h2 class="step-question">Have you been pre-approved for a mortgage?</h2>
        <div class="choice-group">
          <div class="choice-btn">
            <input type="radio" name="preapproved" id="pre-yes" value="Yes" onchange="autoNext(5)" />
            <label for="pre-yes">Yes, I'm pre-approved</label>
          </div>
          <div class="choice-btn">
            <input type="radio" name="preapproved" id="pre-inprogress" value="In Progress" onchange="autoNext(5)" />
            <label for="pre-inprogress">In progress</label>
          </div>
          <div class="choice-btn">
            <input type="radio" name="preapproved" id="pre-no" value="No" onchange="autoNext(5)" />
            <label for="pre-no">Not yet</label>
          </div>
        </div>
      </div>

      <!-- Step 6: Own a home + timeline -->
      <div class="step" id="step-6">
        <h2 class="step-question">Do you currently own a home?</h2>
        <div class="choice-group" style="margin-bottom: 28px;">
          <div class="choice-btn">
            <input type="radio" name="owns_home" id="own-yes" value="Yes" />
            <label for="own-yes">Yes</label>
          </div>
          <div class="choice-btn">
            <input type="radio" name="owns_home" id="own-no" value="No" />
            <label for="own-no">No</label>
          </div>
        </div>

        <h2 class="step-question" style="font-size: 22px;">When are you looking to buy?</h2>
        <div class="choice-group">
          <div class="choice-btn">
            <input type="radio" name="timeline" id="tl-asap" value="ASAP" />
            <label for="tl-asap">As soon as possible</label>
          </div>
          <div class="choice-btn">
            <input type="radio" name="timeline" id="tl-1-3" value="1-3 months" />
            <label for="tl-1-3">1–3 months</label>
          </div>
          <div class="choice-btn">
            <input type="radio" name="timeline" id="tl-3-6" value="3-6 months" />
            <label for="tl-3-6">3–6 months</label>
          </div>
          <div class="choice-btn">
            <input type="radio" name="timeline" id="tl-6-12" value="6-12 months" />
            <label for="tl-6-12">6–12 months</label>
          </div>
          <div class="choice-btn">
            <input type="radio" name="timeline" id="tl-explore" value="Just exploring" />
            <label for="tl-explore">Just exploring</label>
          </div>
        </div>

        <button class="step-btn" onclick="submitForm()">Complete Check-In →</button>
        <p class="privacy-note">Your information is private and will only be used to follow up about this home and your search.</p>
      </div>

    </div>
  </div>

</div><!-- /#form-screen -->


<!-- ════════════════════════════════
     SUCCESS SCREEN
════════════════════════════════ -->
<div id="success-screen">

  <div class="success-hero">
    <div class="success-hero-inner">
      <div class="checkmark">
        <svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="20 6 9 17 4 12"/>
        </svg>
      </div>
      <h2>You're checked in!</h2>
      <p>Thanks for visiting. Tawnya will be<br>in touch with more details.</p>
    </div>
  </div>

  <div class="success-body">

    <!-- Pre-approval CTA — shown only if not preapproved -->
    <div class="cta-card animate delay-1" id="preapproval-cta" style="display:none;">
      <p class="cta-card-eyebrow">Preferred Lender · West Ridge Financial</p>
      <h3>Know your buying power before you fall in love with a home</h3>
      <p>Getting pre-approved takes minutes and puts you in a stronger position as a buyer. Nick at West Ridge Financial specializes in making the process simple — especially for complex financial situations.</p>
      <a href="https://westridgefinancial.com" class="cta-link" target="_blank">Get Pre-Approved →</a>
    </div>

    <!-- Already pre-approved CTA -->
    <div class="cta-card animate delay-1" id="approved-cta" style="display:none;">
      <p class="cta-card-eyebrow">Preferred Lender · West Ridge Financial</p>
      <h3>Questions about financing this home?</h3>
      <p>Nick at West Ridge Financial can walk you through rates, estimated payments, and loan options specific to this property.</p>
      <a href="https://westridgefinancial.com" class="cta-link" target="_blank">Connect with Nick →</a>
    </div>

    <!-- Receipt -->
    <div class="receipt-card animate delay-2">
      <p class="receipt-label">Your Check-In Summary</p>
      <div class="receipt-row">
        <span class="receipt-key">Property</span>
        <span class="receipt-val">5537 W Kensington Cir</span>
      </div>
      <div class="receipt-row">
        <span class="receipt-key">Open House</span>
        <span class="receipt-val">Saturday, Feb 21</span>
      </div>
      <div class="receipt-row">
        <span class="receipt-key">Name</span>
        <span class="receipt-val" id="receipt-name">—</span>
      </div>
      <div class="receipt-row">
        <span class="receipt-key">Email</span>
        <span class="receipt-val" id="receipt-email">—</span>
      </div>
      <div class="receipt-row">
        <span class="receipt-key">Listing Agent</span>
        <span class="receipt-val">Tawnya Krull · Century 21</span>
      </div>
    </div>

  </div>
</div><!-- /#success-screen -->

<script>
  const TOTAL_STEPS = 6;
  let currentStep = 1;

  // Phone formatting
  document.getElementById('phone').addEventListener('input', function(e) {
    let v = e.target.value.replace(/\D/g, '').slice(0, 10);
    if (v.length >= 7) v = `(${v.slice(0,3)}) ${v.slice(3,6)}-${v.slice(6)}`;
    else if (v.length >= 4) v = `(${v.slice(0,3)}) ${v.slice(3)}`;
    else if (v.length > 0) v = `(${v}`;
    e.target.value = v;
  });

  function updateProgress(step) {
    const pct = (step / TOTAL_STEPS) * 100;
    document.getElementById('progress-fill').style.width = pct + '%';
    document.getElementById('progress-count').textContent = `Step ${step} of ${TOTAL_STEPS}`;
  }

  function showStep(n) {
    const current = document.getElementById(`step-${currentStep}`);
    current.classList.remove('active');
    current.classList.add('exit');
    setTimeout(() => { current.classList.remove('exit'); }, 280);

    currentStep = n;
    const next = document.getElementById(`step-${n}`);
    next.classList.add('active');
    updateProgress(n);

    // Focus first input in next step if it's a text step
    setTimeout(() => {
      const input = next.querySelector('input[type="text"], input[type="email"], input[type="tel"]');
      if (input) input.focus();
    }, 50);

    window.scrollTo({ top: document.querySelector('.form-section').offsetTop - 16, behavior: 'smooth' });
  }

  // Auto-advance when a radio is selected (for choice steps)
  function autoNext(fromStep) {
    setTimeout(() => showStep(fromStep + 1), 380);
  }

  function showErr(id, msg) {
    const el = document.getElementById(id + '-err');
    el.textContent = msg || 'Required';
    el.classList.add('show');
    document.getElementById(id).classList.add('error');
  }

  function clearErr(id) {
    document.getElementById(id + '-err').classList.remove('show');
    document.getElementById(id).classList.remove('error');
  }

  function nextStep(from) {
    if (from === 1) {
      const fname = document.getElementById('fname').value.trim();
      const lname = document.getElementById('lname').value.trim();
      let ok = true;
      if (!fname) { showErr('fname', 'Required'); ok = false; } else clearErr('fname');
      if (!lname) { showErr('lname', 'Required'); ok = false; } else clearErr('lname');
      if (!ok) return;
    }
    if (from === 2) {
      const email = document.getElementById('email').value.trim();
      if (!email || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
        showErr('email', 'Valid email required'); return;
      } else clearErr('email');
    }
    if (from === 3) {
      const phone = document.getElementById('phone').value.replace(/\D/g, '');
      if (phone.length < 10) { showErr('phone', 'Valid phone number required'); return; }
      else clearErr('phone');
    }
    showStep(from + 1);
  }

  function submitForm() {
    const data = {
      fname: document.getElementById('fname').value.trim(),
      lname: document.getElementById('lname').value.trim(),
      email: document.getElementById('email').value.trim(),
      phone: document.getElementById('phone').value.trim(),
      has_agent: document.querySelector('input[name="has_agent"]:checked')?.value || 'Not answered',
      preapproved: document.querySelector('input[name="preapproved"]:checked')?.value || 'Not answered',
      owns_home: document.querySelector('input[name="owns_home"]:checked')?.value || 'Not answered',
      timeline: document.querySelector('input[name="timeline"]:checked')?.value || 'Not answered',
      property: '5537 W Kensington Cir, Highland UT 84003',
      listing_agent: 'Tawnya Krull',
      open_house_date: 'February 21, 2026',
      timestamp: new Date().toISOString()
    };

    fetch('https://hooks.zapier.com/hooks/catch/18694809/uczy0o2/', {
      method: 'POST',
      mode: 'no-cors',
      body: new URLSearchParams(data)
    });

    console.log('Lead captured:', data);

    // Show success screen
    document.getElementById('form-screen').style.display = 'none';
    const successScreen = document.getElementById('success-screen');
    successScreen.classList.add('show');

    document.getElementById('receipt-name').textContent = `${data.fname} ${data.lname}`;
    document.getElementById('receipt-email').textContent = data.email;

    if (data.preapproved === 'No') {
      document.getElementById('preapproval-cta').style.display = 'block';
    } else {
      document.getElementById('approved-cta').style.display = 'block';
    }

    window.scrollTo({ top: 0, behavior: 'smooth' });
  }

  // Allow Enter key to advance on text steps
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Enter' && currentStep <= 3) {
      e.preventDefault();
      nextStep(currentStep);
    }
  });
</script>

</body>
</html>
